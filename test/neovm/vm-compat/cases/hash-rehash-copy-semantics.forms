; hash-table rehash accessors and copy-hash-table semantics.
(hash-table-rehash-size (make-hash-table))
(hash-table-rehash-threshold (make-hash-table))
(hash-table-rehash-size (make-hash-table :rehash-size 2.0))
(hash-table-rehash-size (make-hash-table :rehash-size 2))
(hash-table-rehash-size (make-hash-table :rehash-size 1.25))
(hash-table-rehash-threshold (make-hash-table :rehash-threshold 0.5))
(hash-table-rehash-threshold (make-hash-table :rehash-threshold 0.9))

(hash-table-p (condition-case err (make-hash-table :rehash-size -1) (error err)))
(hash-table-p (condition-case err (make-hash-table :rehash-size 1) (error err)))
(hash-table-p (condition-case err (make-hash-table :rehash-size t) (error err)))
(hash-table-p (condition-case err (make-hash-table :rehash-threshold 0.0) (error err)))
(hash-table-p (condition-case err (make-hash-table :rehash-threshold 1.0) (error err)))
(hash-table-p (condition-case err (make-hash-table :rehash-threshold -0.1) (error err)))
(hash-table-p (condition-case err (make-hash-table :rehash-threshold 1.1) (error err)))
(hash-table-p (condition-case err (make-hash-table :rehash-threshold t) (error err)))

(let* ((h (make-hash-table :test 'eq :size 9 :weakness 'key))
       (c (copy-hash-table h)))
  (list (hash-table-test c) (hash-table-size c) (hash-table-weakness c)))

(let* ((h (make-hash-table :test 'eq))
       (c (copy-hash-table h))
       (k (make-symbol "k")))
  (puthash k 10 h)
  (list (gethash k h 'missing) (gethash k c 'missing)))

(condition-case err (hash-table-rehash-size 7) (error (car err)))
(condition-case err (hash-table-rehash-threshold 7) (error (car err)))
(condition-case err (copy-hash-table 7) (error (car err)))
