; Remaining 4-level cxr accessor semantics.

(defun vm--cxr-input (ops)
  (let ((v 1)
        (i (1- (length ops))))
    (while (>= i 0)
      (setq v (if (eq (aref ops i) ?a) (cons v 0) (cons 0 v)))
      (setq i (1- i)))
    v))

(cdaaar (vm--cxr-input "aaad"))
(cdaadr (vm--cxr-input "daad"))
(cdadar (vm--cxr-input "adad"))
(cdaddr (vm--cxr-input "ddad"))
(cddaar (vm--cxr-input "aadd"))
(cddadr (vm--cxr-input "dadd"))
(cdddar (vm--cxr-input "addd"))

(list
 (cdaaar nil) (cdaadr nil) (cdadar nil) (cdaddr nil)
 (cddaar nil) (cddadr nil) (cdddar nil))

(condition-case err
    (cdaaar '(1 . 0))
  (error (list (car err) (car (cdr err)))))

(condition-case err
    (cdddar '(1 . 0))
  (error (list (car err) (car (cdr err)))))
