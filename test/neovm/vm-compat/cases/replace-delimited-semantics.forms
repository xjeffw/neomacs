(fboundp 'replace-string)
(fboundp 'replace-regexp)
(fboundp 'query-replace)
(fboundp 'query-replace-regexp)

(with-temp-buffer
  (insert "foo foobar foo")
  (goto-char (point-min))
  (replace-string "foo" "bar" t)
  (buffer-string))

(with-temp-buffer
  (insert "Foo foobar foo")
  (goto-char (point-min))
  (replace-string "foo" "bar" t)
  (buffer-string))

(with-temp-buffer
  (insert "foo1 1foo foo")
  (goto-char (point-min))
  (replace-string "foo" "x" t)
  (buffer-string))

(with-temp-buffer
  (insert "foo_foo foo-foo")
  (goto-char (point-min))
  (replace-string "foo" "x" t)
  (buffer-string))

(with-temp-buffer
  (insert "foo foobar foo")
  (goto-char (point-min))
  (replace-regexp "foo" "bar" t)
  (buffer-string))

(with-temp-buffer
  (insert "foo1 1foo foo")
  (goto-char (point-min))
  (replace-regexp "foo" "x" t)
  (buffer-string))

(with-temp-buffer
  (insert "foo foobar foo")
  (goto-char (point-min))
  (let ((unread-command-events (list ?!)))
    (query-replace "foo" "bar" t))
  (buffer-string))

(with-temp-buffer
  (insert "foo foobar foo")
  (goto-char (point-min))
  (let ((unread-command-events (list ?!)))
    (query-replace-regexp "foo" "bar" t))
  (buffer-string))
