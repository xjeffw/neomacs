; deactivate-mark / exchange-point-and-mark command semantics.
(with-temp-buffer
  (set-mark (point-min))
  (setq mark-active t)
  (list (deactivate-mark) (use-region-p) (mark t)))

(with-temp-buffer
  (insert "abc")
  (goto-char (point-max))
  (set-mark (point-min))
  (setq mark-active t)
  (deactivate-mark)
  (list (use-region-p) (mark t) (point)))

(with-temp-buffer
  (condition-case err
      (exchange-point-and-mark)
    (error (car err))))

(with-temp-buffer
  (insert "abc")
  (goto-char (point-max))
  (set-mark (point-min))
  (condition-case err
      (progn
        (exchange-point-and-mark)
        (list (point) (mark t) (use-region-p)))
    (error (car err))))

(with-temp-buffer
  (insert "abc")
  (goto-char (point-max))
  (set-mark (point-min))
  (setq mark-active nil)
  (exchange-point-and-mark)
  (list (point) (mark t) (use-region-p)))
