; yank-pop should track replacement region via mark/point across edits.
(with-temp-buffer
  (setq kill-ring (list "a" "b" "c"))
  (setq kill-ring-yank-pointer '(1 2))
  (yank)
  (erase-buffer)
  (setq last-command 'yank)
  (yank-pop 1)
  (list (buffer-string) (car kill-ring-yank-pointer) (mark) (point)))

(with-temp-buffer
  (setq kill-ring (list "a" "b" "c"))
  (setq kill-ring-yank-pointer '(1 2))
  (yank)
  (delete-region (point-min) (point-max))
  (setq last-command 'yank)
  (yank-pop -1)
  (list (buffer-string) (car kill-ring-yank-pointer) (mark) (point)))

(with-temp-buffer
  (setq kill-ring (list "a" "b" "c"))
  (setq kill-ring-yank-pointer '(1 2))
  (yank)
  (goto-char (point-min))
  (insert "zz")
  (setq last-command 'yank)
  (yank-pop 1)
  (list (buffer-string) (car kill-ring-yank-pointer) (mark) (point)))
