; yank-pop behavior when mark is moved/cleared via set-mark / set-marker (mark-marker).
(with-temp-buffer
  (setq kill-ring (list "a" "b" "c"))
  (yank)
  (set-mark (point))
  (setq last-command 'yank)
  (yank-pop 1)
  (list (buffer-string) (mark t) (point) (car kill-ring-yank-pointer)))

(with-temp-buffer
  (setq kill-ring (list "a" "b" "c"))
  (yank)
  (set-mark (point-min))
  (setq last-command 'yank)
  (yank-pop 1)
  (list (buffer-string) (mark t) (point) (car kill-ring-yank-pointer)))

(with-temp-buffer
  (setq kill-ring (list "a" "b" "c"))
  (yank)
  (set-marker (mark-marker) nil)
  (setq last-command 'yank)
  (condition-case err
      (yank-pop 1)
    (error (list (car err) (car (cdr err)) (buffer-string) (mark t) (point) (car kill-ring-yank-pointer)))))

(with-temp-buffer
  (setq kill-ring (list "a" "b" "c"))
  (yank)
  (goto-char (point-min))
  (set-marker (mark-marker) nil)
  (setq last-command 'yank)
  (condition-case err
      (yank-pop -1)
    (error (list (car err) (car (cdr err)) (buffer-string) (mark t) (point) (car kill-ring-yank-pointer)))))
